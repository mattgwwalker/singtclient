<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Singt - Singer</title>
    <link rel="icon" type="image/png" href="img/singt_32x32.png">
    
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/singt.css" rel="stylesheet">
    <script src="./js/jquery-3.5.1.js" defer></script>
    <script src="./js/bootstrap.min.js" defer></script>
    <script src="./js/singer.js" defer></script>

    <!--<link href="navbar.css" rel="stylesheet">-->
  </head>
  <body>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <div class="container-xl">
        <span class="navbar-brand">Singt</span>

        <!-- the menu button that gets revealed if composer window is small-->
        <button class="navbar-toggler" type="button" data-toggle="collapse"
                data-target="#navbar_composer" aria-controls="navbar_composer"
                aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbar_composer">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="#page_setup">Setup</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#page_connect">
                Connect
                <span class="d-none badge badge-pill badge-danger pulse">&nbsp;</span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#page_debug">Debug</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-xl mt-5 mb-3">
      <!-- Tracks -->
      <div id="page_setup" class="page">
        <div class="card">
          <div class="card-header">
            <h2>
              <img src="./icons/gear.svg" alt="" width="32" height="32" class="mr-2">
              Setup
            </h2>
          </div>
          <div class="card-body">
            <p class="mb-3">
              To use Singt, you'll need to have
              your <strong>headphones plugged in</strong> as it's very
              important that the computer can't hear itself.  If you
              don't wear headphones everyone else will hear horrible
              feedback and they might stop being your friend.
            </p>

            <p class="mb-3">It's also important that your headphones
              are <strong>wired</strong>; Bluetooth connections add
              considerable latency, which we're trying to avoid.
            </p>
            <p class="mb-3">
              Before we can connect and sing together we need to know
              a few technical things about your computer and how it
              records your voice.
            </p>
            <p class="mb-3">
              Once you've finished with the setup measurements below,
              please select the 'connect' tab and connect to the
              server.
            </p>
          </div> <!-- /card-body -->


          <div class="card-body">
            <h3>Gain for Discussion</h3>
            
            <p class="mb-3">
              The first thing we're going to do is measure how loudly
              the computer hears you speak.  This depends on both how
              loudly you speak and also where you are relative to your
              microphone.  During this test make sure you're sitting
              or standing as you will for "discussion mode" and then
              speak as loudly as you do normally.
            </p>

            <p class="mb-3">
              We will calculate the <em>gain</em> required such that
              your voice will be approximately the same volume as the
              other participants.
            </p>

	         <button class="btn btn-primary mr-2"
                    id="button_measure_gain_discussion">
              Measure Gain for Discussion
            </button>

            <div class="mt-3" id="measure_gain_discussion_results">
            </div>
              
          </div> <!-- /card-body -->

          
          <div class="card-body">
            <h3>Gain for Recordings</h3>
            
            <p class="mb-3">
              The second thing we need to know is how loudly the
              computer hears you sing.  This depends on both how
              loudly you sing and also where you are relative to your
              microphone.  During this test make sure you're sitting
              or standing as you will during recordings and then sing
              as loudly as you do normally.
            </p>

            <p class="mb-3">
              We will calculate the <em>gain</em> required such that
              your voice will be approximately the same volume as the
              other singers.
            </p>

	         <button class="btn btn-primary mr-2"
                    id="button_measure_gain_recordings">
              Measure Gain for Recordings
            </button>
            
            <div class="mt-3" id="measure_gain_recordings_results">
            </div>
              
          </div> <!-- /card-body -->

          
          
          <div class="card-body">
            <h3>Loop-Back Latency for Recordings</h3>
            <p class="mb-3">
              The final thing we need to know is how much time passes
              between Singt asking for your computer to play a sound
              and your computer recording that same sound.  We'll call
              this <em>loop-back latency</em>.  We need to know this
              value in order to synchronise your voice with the
              backing tracks that you'll sing to.
            </p>
            <p class="mb-3">
              For this test you need to take your headphones off your
              head and place one earpiece as close as possible to your
              microphone, then turn the volume up about half way.
            </p>
            <p class="mb-3">
              Depending on your setup, it may look like one of these
              scenarios:
            </p>
            <div id="carousel-loop-back-scenarios" class="carousel slide w-50" data-ride="carousel">
              <ol class="carousel-indicators">
                <li data-target="#carousel-loop-back-scenarios" data-slide-to="0" class="active"></li>
                <li data-target="#carousel-loop-back-scenarios" data-slide-to="1"></li>
                <li data-target="#carousel-loop-back-scenarios" data-slide-to="2"></li>
                <li data-target="#carousel-loop-back-scenarios" data-slide-to="3"></li>
                <li data-target="#carousel-loop-back-scenarios" data-slide-to="4"></li>
                <li data-target="#carousel-loop-back-scenarios" data-slide-to="5"></li>
              </ol>
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <img src="img/computer-mic.jpg" class="d-block w-100" alt="Computer microphone">
                </div>
                <div class="carousel-item">
                  <img src="img/computer-loop-back.jpg" class="d-block w-100" alt="Computer loop-back">
                </div>
                <div class="carousel-item">
                  <img src="img/headphones-mic.jpg" class="d-block w-100" alt="Headphones microphone">
                </div>
                <div class="carousel-item">
                  <img src="img/headphones-loop-back.jpg" class="d-block w-100" alt="Headphones loop-back">
                </div>
                <div class="carousel-item">
                  <img src="img/earphones-mic.jpg" class="d-block w-100" alt="Earphones microphone">
                </div>
                <div class="carousel-item">
                  <img src="img/earphones-loop-back.jpg" class="d-block w-100" alt="Earphones loop-back">
                </div>
              </div>
              <a class="carousel-control-prev" href="#carousel-loop-back-scenarios" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carousel-loop-back-scenarios" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
            <p class="my-3">
              You'll need to make as little noise as possible during
              the test.  (We'll tell you when it's safe to breathe
              again.)  When you're ready, click the button labelled
              "Measure Loop-Back Latency for Recordings" below.
            </p>

	         <button class="btn btn-primary mr-2"
                    id="button_measure_loop_back_latency_recordings">
              Measure Loop-Back Latency for Recordings
            </button>
            
            <div class="mt-3" id="measure_loop_back_latency_recordings_results">
            </div>
              
          </div> <!-- /card-body -->

            
          
        </div> <!-- /card -->
      </div>

      <!-- Connect -->
      <div id="page_connect" class="page">
        <div class="d-none card" id="card_connect">
          <div class="card-header">
            <h2>
              <img src="./icons/people.svg" alt="" width="32" height="32" class="mr-2">
              Connect
            </h2>
          </div>
          <div class="card-body">
            <p class="mb-3">
              Enter your name (as you wish to be known by the others
              on the server) and the server's IP address (given to you
              by the conductor) and press the "Connect to Server" button.
            </p>
            <div class="row">
              <div class="col">
                <h3>Details</h3>

                <form id="form_recording">
                  <div class="form-group row">
                    <label class="col-sm-2 col-form-label">
                      Name
                    </label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="name_input" placeholder="Luciano">
                    </div>
                  </div>
                  
                  <div class="form-group row">
                    <label class="col-sm-2 col-form-label">
                      IP Address
                    </label>
                    <div class="col-sm-10">
                      <input type="text" class="form-control" id="address_input" placeholder="127.0.0.1">
                    </div>
                  </div>

                  <button class="btn btn-primary"
                          id="connect-button">
                    Connect to Server
                  </button>
                </form>
              </div>
            </div>
          </div>
        </div>  <!-- /card -->

        <div class="d-none card" id="card_connected">
          <div class="card-header">
            <h2>
              <img src="./icons/people-fill.svg" alt="" width="32" height="32" class="mr-2">
              Connected
            </h2>
          </div>
          <div class="card-body">
            <p class="mb-3">
              You're connected.
            </p>
            <button class="btn btn-primary"
                    id="button_disconnect">
              Disconnect from Server
            </button>
          </div> <!-- /card-body -->
          
        </div> <!-- /card -->
      </div> <!-- /page -->

      <!-- Debug -->
      <div id="page_debug" class="page">
        <div class="card">
          <div class="card-header">
            <h2>
              <img src="./icons/bug.svg" alt="" width="32" height="32" class="mr-2">
              Debug
            </h2>
          </div>
          <div class="card-body">
            <p class="mb-3">
              The following can be ignored unless there's trouble.  In
              trouble's case, Matthew might ask you to click on one of
              these buttons.
            </p>
          </div>
          
          <div class="card-body">
            <h3>
              Check Playback
            </h3>

            <div class="card-body">
              <p class="" id="test">Check that playback is working by
                clicking the "Play" button.  You should be able to
                hear Adleisia warming up.
              </p>
	           <button class="btn btn-primary mr-2"
                      id="button_check_playback_play">
                Play
              </button>
	           <button class="btn btn-secondary mr-2"
                      id="button_check_playback_stop">
                Stop
              </button>
              <p class="mt-3" id="check_playback_results"></p>
            </div> <!-- /card-body -->
          </div> <!-- /card-body -->
          
          <div class="card-body">
            <h3>
              Check Recording
            </h3>

            <div class="card-body">
              <p class="" id="test">Check that recording is working by
              pressing the "Record and Playback" button.  Your
              computer will then immediately record you for three
              seconds.  Say "testing, testing, one, two, three" or
              sing a wee song to your future self.  Once the three
              seconds are over, your computer will immediately play
              back the recording and you should be able to hear
              yourself.
              </p>
	           <button class="btn btn-primary mr-2"
                      id="button_check_recording_record">
                Record and Playback
              </button>
              <p class="mt-3" id="check_recording_results"></p>
            </div> <!-- /card-body -->
          </div> <!-- /card-body -->
          
          <div class="card-body">
	         <h3>
              Measure Loop-Back Levels
            </h3>
          </div> <!-- /card-body -->
          
          <div class="card-body">
	         <h3>
              Measure Loop-Back Latency for Voice
            </h3>
          </div> <!-- /card-body -->
          
          </div>
        </div>
      </div>


    </div>
  </body>
</html>
